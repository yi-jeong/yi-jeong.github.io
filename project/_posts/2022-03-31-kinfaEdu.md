---
layout: post
title: 서민금융진흥원 금융교육포탈 인트로
categories: [Project]
tags: [Publishing, JS, Design]
feature-img: "assets/img/project/KINFA_EDU_WEB.jpeg"
hidden: true
---


<p class="box-title"># 기여도</p>

🎨 **디자인** 100%  
📝 **퍼블리싱** 100%  
🛠 **스크립트구현** 100%  

----
<p class="box-title"># 작업 환경 및 기술스택</p>

**DESIGN**  
   ⭐️ XD  
   ⭐️ Photoshop  
   ⭐️ Illustrator

**VCS**  
   ⭐️ Git

**IDE**   
   ⭐️ IntelliJ 2022   

**FRONT**  
   ⭐️ Swiper 4.5.1  
   ⭐️ Java Script(es5)

----

<p class="box-title"># 작업 내용</p>

🗓 **작업기간**  2022. 02. 23 ~ 2022. 03. 31

--- 

📌 **디자인 시안 작업**   

📌 **썸네일 이미지 제작 및 최적화 작업** 

📌 **웹/모바일 반응형 작업**  

<p style="text-align: left;">
<img src="{{ site.baseurl }}/assets/img/project/KINFA_EDU_WEB.jpeg">
<img class="ylong-img" src="{{ site.baseurl }}/assets/img/project/KINFA_EDU_MOBILE.png">
</p>

📌 **자바스크립트를 이용한 화면 랜더링 구현** 
```js
   var IntroRenderManager = (function () {
      // rawData
      var eduIntroListStr = ${data};
      var eduTargetCodeListStr = ${codeData};

      // data
      var eduIntroMap, eduTargetCodeMap;

      // 더 보기 영상 링크 목록
      var moreEduUrlMap;

      // 유틸
      strToJson = function (str) {
         return (str === "") ? {} : JSON.parse(str);
      };

      groupByKey = function(data, key) {
         return data.reduce(function (carry, el) {
               var group = el[key];

               if (carry[group] === undefined) {
                  carry[group] = [];
               }
               carry[group].push(el);

               return carry;
         }, {});
      };

      toMap = function(data) {
         return data.reduce(function (map, code) {
               map.set(code.MT_SUB_NAME, code.MT_SUB_CODE);
               return map;
         }, new Map());
      };

      initBtnState = function (btns) {
         for (var i = 0; i < btns.length; i++) {
            var btn = btns[i];
            btn.classList.remove("active");
         }
      };

      // 유틸//
      setIntroInfo = function () {
         var eduIntroList = strToJson(eduIntroListStr);
         var eduTargetCodeList = strToJson(eduTargetCodeListStr);

         eduIntroMap = groupByKey(eduIntroList, 'MT_LEC_TARGET_CODE');
         // key: 청소년, value: EI0001
         eduTargetCodeMap = toMap(eduTargetCodeList);

         // 더많은영상보기 map 설정(ie 호환성 추가)
         moreEduUrlMap = new Map();
         moreEduUrlMap.set('청소년', 'https://edu.kinfa.or.kr/academy/course/onDetail.do?ref1=YOUNG');
         moreEduUrlMap.set('청년·대학생', 'https://edu.kinfa.or.kr/academy/course/onDetail.do?ref1=YOUTH');
         moreEduUrlMap.set('중장년', 'https://edu.kinfa.or.kr/academy/course/onDetail.do?ref1=CNSMR');
         moreEduUrlMap.set('시니어', 'https://edu.kinfa.or.kr/academy/course/onDetail.do?ref1=SENIOR');
         moreEduUrlMap.set('청각장애인', 'https://edu.kinfa.or.kr/academy/course/onDetail.do?ref1=DEAF&mtScCode=SC7105');
         moreEduUrlMap.set('북한이탈주민', 'https://edu.kinfa.or.kr/academy/course/onDetail.do?ref1=DEAF&mtScCode=SC7106');

      };

      setScrollEvent = function(){
         var topBtn = document.querySelector('.intro-top');

         //스크롤 이벤트
         document.addEventListener('scroll', function(e){
               //e.preventDefault();

               if(window.scrollY > 80){
                  topBtn.classList.add('block')
               }else{
                  topBtn.classList.remove('block');
               }

         })

         //버튼 클릭 시 상단으로 이동
         topBtn.addEventListener("click", function(e){
               e.preventDefault();
               document.getElementById('top').scrollIntoView({ behavior: 'smooth' });
         });

      };

      setMenuEvent = function () {
         // 메인메뉴 버튼 이벤트 초기화
         var mainContentBtns = document.querySelectorAll('.main-content-btn');

         for (var i = 0; i < mainContentBtns.length; i++) {

               var mainContentBtn = mainContentBtns[i];

               mainContentBtn.addEventListener('click', function (e) {
                  //e.stopPropagation();
                  //e.preventDefault();

                  initBtnState(mainContentBtns);

                  var eduTargetText = e.currentTarget.getAttribute('edu-key');

                  // 동영상 리스트 영역으로 부드럽게 이동
                  if (window.innerWidth<768){
                  document.getElementById('box').scrollIntoView({ behavior: 'smooth' });
                  }
                  // 컨텐츠 타이틀 추가
                  document.querySelector('.content-tit > h2').innerText = eduTargetText;

                  // 인트로 데이터 설정
                  setIntroData(eduTargetText);
               });
         }
      };

      setIntroData = function (targetName){
         var wrapper = document.querySelector('.swiper-wrapper');
         var eduTargetCode = eduTargetCodeMap.get(targetName);
         var eduIntroInfos = eduIntroMap[eduTargetCode];

         wrapper ? wrapper.innerHTML = '' : '';

         setContent(eduIntroInfos);
         setMoreEduBtn(moreEduUrlMap.get(targetName));
      };

      moveTo = function(url) {
         window.location.href = url;
      };

      setMoreEduBtn = function(url) {
         document.querySelector('#moreEduBtn').href = url;
      };

      setContent = function (dataArr) {
         var wrapUl = document.querySelector(".swiper-wrapper");
         // 데이터가 없는 경우
         if (dataArr == undefined || dataArr.length == 0) {
               wrapUl.innerHTML = "<li class='none-data'>데이터가 없습니다</li>";
               return;
         }

         // 인트로 데이터 랜더링
         for (var i = 0; i < dataArr.length; i++) {
               var data = dataArr[i];

               var hashTagLi = "";
               if (data.HASHTAG) {
                  var hashtags = data.HASHTAG.split(',');
                  hashtags.forEach(function (tag) {
                     hashTagLi += "<li>" + tag + "</li>";
                  });
               }

               // 링크 url 예외처리 처리
               var eduUrl = data.URL;
               if (data.URL.indexOf('http') == -1) {
                  eduUrl = 'https://' + data.URL;
               }
               
               var dataSrc = data.IMG_SRC.substring(data.IMG_SRC.indexOf("/edu-data"));

               wrapUl.innerHTML +=
                  "<li class='swiper-slide'>" +
                     "<div class='swiper-container' style='width:100%;' onclick='moveTo(\""+eduUrl+"\");'>" +
                           "<div class='slide-img'> " +
                              /* "<img src='/getImages.do?type=intro&id=intro&file="+ data.SAVFILE +"' alt='" + data.IMG_ALT + "'>" + */
                              "<img src='" + dataSrc +"' alt='" + data.IMG_ALT + "'>" + 
                           "</div>" +
                     "<h3>" + data.TITLE + "</h3> " +
                     "<ul class='hashtag'>"+ hashTagLi + "</ul> " +
                     "</div> " +
                  "</li>";
         }

         setSwiper();
      };

      setSwiper = function () {
         var width = window.innerWidth;

         var swiperConfig = {
               spaceBetween: 10,
               slidersPerGroup: 3,
               loop: false,
               loopFillGroupWithBlank: true,
               pagination: {
                  el: ".swiper-pagination",
                  clickable: true,
               },
               navigation: {
                  nextEl: ".swiper-button-next",
                  prevEl: ".swiper-button-prev",
               },
         };

         if (width > 992)        swiperConfig.slidesPerView = 5;
         else if (width < 768)   swiperConfig.slidesPerView = 1;
         else                    swiperConfig.slidesPerView = 3;

         var swiper = new Swiper(".mySwiper", swiperConfig);
      };

      return {
         render: function () {
            setIntroInfo();
            setMenuEvent();
            setScrollEvent();
         },
         initContent: function () {
            setIntroData('청소년');
         }
      }
   });

   document.addEventListener('DOMContentLoaded', function () {
      var introRenderManger = new IntroRenderManager();
      introRenderManger.render();
      introRenderManger.initContent();
   });
``` 

자바 단에서 Model로 데이터를 넘겨준 값을 변수에 담아 JSON 형태의 데이터로 가공했다.  
가공한 데이터는 랜더링하기 좋은 형태로 조합해 화면에 랜더링해주었다.  
조합에는 reduce 함수를 사용하였다.  
화면 디바이스 크기별로 swiper view 갯수를 조절하였다 😀 


